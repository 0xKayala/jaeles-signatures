# info to search signature
id: template-injection-01
type: fuzz
info:
  name: Template Injection
  risk: High

# origin: gonna come from Burp
payloads:
    - '${9*9}'
    - '${{"{{"}}9*9{{"}}"}}'
    - '<%= 9 * 9 %>'
    - '#{ 9 * 9 }'

requests:
  - generators:
      - Query("{{.payload}}")
      - Body("{{.payload}}")
      - Path("{{.payload}}", "*")
      - Cookie("{{.payload}}", "*")
    # if response have result of template code above
    detections:
      - >-
        StringSearch("response", "81") && (StringCount("response", "81") > StringCount("oresponse", "81"))
  # another request builder with URL encode the payload
  - encoding: URL()
    generators:
      - Query("{{.payload}}")
      - Body("{{.payload}}")
      - Path("{{.payload}}", "*")
      - Cookie("{{.payload}}", "*")
    # if response have result of template code above
    detections:
      - >-
        StringSearch("response", "81") && (StringCount("response", "81") > StringCount("oresponse", "81"))

