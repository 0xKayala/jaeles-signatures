# info to search signature
id: open-param-fuzz-base
type: fuzz
info:
  name: Open Redirect FUZZ on Param
  risk: Medium

variables:
  - dest: |
      google.com
      http://google.com
      example.com

payloads:
  - '{{.dest}}'
  - '\{{.dest}}'
  - '//{{.dest}}/'
  - '\/\/{{.dest}}/'
  - '%00\/\/{{.dest}}/'
  - '/%00/{{.dest}}/'
  - '/%09/{{.dest}}/'
  - '/%0a/{{.dest}}/'
  - '/%0d/{{.dest}}/'
  - '////{{.dest}}/%2f%2e%2e'
  - '/%5c{{.dest}}/%2f%2e%2e'
  - '/ã€±{{.dest}}/%2f%2e%2e'
  - '@{{.dest}}'

requests:
    # generate request base on original param
  - generators:
      - Query("{{.payload}}")
      - Query("[[.original]]{{.payload}}")
    detections:
      - >-
        (StatusCode() >= 300 && StatusCode() < 400) && StringSearch("resHeaders", "Location: https://{{.payload}}") && !StringSearch("resHeaders", "Location: {{.BaseURL}}")
